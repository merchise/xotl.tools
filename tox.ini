[tox]
envlist =
   {3.8,3.9,3.10,3.11,3.12,pypy}-unit
   {3.8,3.9,3.10,3.11,3.12,pypy}-greenlets
   {3.8,3.9,3.10,3.11,3.12}-staticcheck

[testenv]
basepython =
    3.6: python3.6
    3.7: python3.7
    3.8: python3.8
    3.9: python3.9
    3.10: python3.10
    3.11: python3.11
    3.12: python3.12
    system: python3
    pypy: pypy3

deps = python-dateutil>=2.8.2
       pytest~=6.1
       hypothesis~=6.91.0
       pytz>=2023.3.post1
       pytest-xdist~=2.1
       coverage[toml]>=7.4.0
       pytest-cov~=2.10

       greenlets: greenlet
       trace: pytest-annotate
       monkey: pytest-monkeytype
       doctest: sphinx>=7.1.2
       staticcheck: mypy>=1.8.0


sitepackages = False
recreate = False
allowlist_externals = make

commands=
   unit: pytest -n auto -l -q --cov=xotl.tools []
   doctest: make -C docs doctest
   greenlets: pytest -n auto -l -q -k greenlet []
   staticcheck: mypy --config-file {toxinidir}/mypy.ini {posargs:"-p xotl.tools"}
   trace: pytest --annotate-output={toxinidir}/annotations.json -l -q []
   monkey: pytest --monkeytype-output={toxinidir}/monkeytype.sqlite3 -l -q []
